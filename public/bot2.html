<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="bot.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
   <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.min.css'>
   <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

<style>
	

		ul.tabs{
			margin: 0px;
			padding: 0px;
			list-style: none;
            /* position: fixed;
            z-index: 99999;
            top: 16px; */
		}
		ul.tabs li{
			/* background: none; */
			color: #222;
			display: inline-block;
			padding: 10px 15px;
			cursor: pointer;
            /* background: #3b3838; */
            border:1px solid #7226e0;
		}

		ul.tabs li.current{
			background: #ededed;
			color: #222;
            border:none;
		}

		.tab-content{
			display: none;
			/* background: #ededed; */
			margin-top: 5px;
		}

		.tab-content.current{
			display: inherit;
		}

/*=====Form==========*/
#msform {
	width: 400px;
	margin: 50px auto;
	text-align: center;
	position: relative;
}
#msform fieldset {
	background: white;
	border: 0 none;
	border-radius: 3px;
	box-shadow: 0 0 15px 1px rgba(0, 0, 0, 0.4);
	padding: 20px 30px;
	
	box-sizing: border-box;
	width: 80%;
	margin: 0 10%;
	position: absolute;
}
#msform fieldset:not(:first-of-type) {
	display: none;
}




</style>
</head>
<body>
  
    <div class="chatbot chatbot--closed">
        <div class="chatbot__header">
          <p><strong>Got a question?</strong> <span class="u-text-highlight">Ask Logibot</span></p>
          <svg class="chatbot__close-button icon-speech" viewBox="0 0 32 32">
            <use xlink:href="#icon-speech" />
          </svg>
          <svg class="chatbot__close-button icon-close" viewBox="0 0 32 32">
            <use xlink:href="#icon-close" />
          </svg>
        </div>
        <div class="chatbot__message-window">
            <div class="container">
                <ul class="tabs">
                    <li class="tab-link current" data-tab="tab-1" onclick="tabtype('queries')">Queries</li>
                    <li class="tab-link" data-tab="tab-2" onclick="tabtype('status')" id="StartChat" class="StartChat">Shipment</li>
                    <li class="tab-link" data-tab="tab-3" onclick="tabtype('agent')"> Execute</li>
                    
                </ul>
            
                <div id="tab-1" class="tab-content current">
                


                    <ul class="chatbot__messages">
                        <li class="is-ai animation">
                          <div class="is-ai__profile-picture">
                            <svg class="icon-avatar" viewBox="0 0 32 32">
                              <use xlink:href="#avatar" />
                            </svg>
                          </div>
                          <span class="chatbot__arrow chatbot__arrow--left"></span>
                          <p class='chatbot__message'>Hi there üñê. I‚Äôm Logibot, your virtual assistant. I'm here to help with your general enquiries.</p>
                        </li>
                        <!-- Answer and response added here -->
                      </ul>
            

                </div>
                <div id="tab-2" class="tab-content">
                    
                     <ul class="chatbot__messages" id="chatwindow">
                      <li class="is-ai animation">
                            <!-- <div class="is-ai__profile-picture">
                            <svg class="icon-avatar" viewBox="0 0 32 32">
                              <use xlink:href="#avatar" />
                            </svg>
                          </div> -->
                          <!-- <span class="chatbot__arrow chatbot__arrow--left"></span> -->
                          <!-- <p class='chatbot__message'></p> -->
                        </li>
                         
                      </ul>
                </div>
                <div id="tab-3" class="tab-content">
                    <div id="msform">
                            <fieldset>
                          <div class="input-group input-group-lg">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-user"> </span></span>
                          <input type="text" class="form-control" placeholder="Frist Name" required id="fname">
                            </div>
                            <br>
                            <div class="input-group input-group-lg">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-lock"> </span></span>
                            <input type="email" class="form-control" placeholder="email" id="email">
                            </div><br>
                                <input type="button" class="btn btn-success" value="Next" id="next">
                            </fieldset>
                    </div>
                    <div id="msg">
                        <ul class="chatbot__messages chatbot__messages3" id="ChatWindowdiv">                            
                         </ul>
                    </div>
                </div>
            </div><!-- container -->
    


        </div>
        <div id="queries">
        <div class="chatbot__entry chatbot--closed">
          <input type="text" class="chatbot__input"  placeholder="Write a message..." />
          <svg class="chatbot__submit" viewBox="0 0 32 32">
            <i class="fas fa-microphone" id="start-record-btn"></i>
        </svg>
        <svg class="chatbot__submit chatbot__submit1" viewBox="0 0 32 32" class=".message">
            <use xlink:href="#icon-send" />
          </svg>
        </div>
        </div>

        <div id="statuscheck">
            <div class="chatbot__entry chatbot--closed">
              <input type="text" class="chatbot__input" id="UserInputBox" placeholder="Write a message..." />
              <svg class="chatbot__submit chatbot__submit2" viewBox="0 0 32 32">
                <i class="fas fa-microphone" id="start-record-btn2"></i>
            </svg>
            <svg class="chatbot__submit chatbot__submit2" viewBox="0 0 32 32" class="message1 .message">
                <use xlink:href="#icon-send" />
              </svg>
            </div>
     </div>

     <div id="agents">
        <div class="chatbot__entry chatbot--closed">
          <input type="text" class="chatbot__input" id="UserInputBox2" placeholder="Write a message..." />
          
        <svg class="chatbot__submit chatbot__submit3" viewBox="0 0 32 32" class="message2 .message">
            <use xlink:href="#icon-send" />
          </svg>
        </div>
 </div>


      </div>
      <h3 class="no-browser-support" hidden>Sorry, Your Browser Doesn't Support the Web Speech API. Try Opening This Demo In Google Chrome.</h3>
      <!-- Symbols -->
      <svg>
        <!-- Close icon -->
        <symbol id="icon-close" viewBox="0 0 32 32">
          <title>Close</title>
          <path d="M2.624 8.297l2.963-2.963 23.704 23.704-2.963 2.963-23.704-23.704z" />
          <path d="M2.624 29.037l23.704-23.704 2.963 2.963-23.704 23.704-2.963-2.963z" />
        </symbol>
      
        <!-- Speech icon -->
        <symbol id="icon-speech" viewBox="0 0 32 32">
          <title>Speech</title>
          <path d="M21.795 5.333h-11.413c-0.038 0-0.077 0-0.114 0l-0.134 0.011v2.796c0.143-0.006 0.273-0.009 0.385-0.009h11.277c0.070 0 7.074 0.213 7.074 7.695 0 5.179-2.956 7.695-9.036 7.695h-3.792c-0.691 0-1.12 0.526-1.38 1.159l-1.387 3.093-1.625 3.77 0.245 0.453h2.56l2.538-5.678h2.837c7.633 0 11.84-3.727 11.84-10.494 0.001-8.564-7.313-10.492-9.875-10.492z" />
          <path d="M10.912 24.259c-0.242-0.442-0.703-0.737-1.234-0.737-0 0-0 0-0 0h-0.56c-0.599-0.011-1.171-0.108-1.71-0.28l0.042 0.012c-1.82-0.559-4.427-2.26-4.427-7.424 0-6.683 5.024-7.597 7.109-7.686v-2.8c-2.042 0.095-9.91 1.067-9.91 10.483 0 4.832 1.961 7.367 3.606 8.64 1.38 1.067 3.109 1.744 4.991 1.843l0.033 0.019 2.805 5.211 1.41-3.273z" />
        </symbol>
      
        <!-- Send icon -->
        <symbol id="icon-send" viewBox="0 0 23.97 21.9">
          <title>Send</title>
          <path d="M0.31,9.43a0.5,0.5,0,0,0,0,.93l8.3,3.23L23.15,0Z" />
          <path d="M9,14.6H9V21.4a0.5,0.5,0,0,0,.93.25L13.22,16l6,3.32A0.5,0.5,0,0,0,20,19l4-18.4Z" />
        </symbol>
       <!-- Speech icon -->
        <symbol id="icon-speech" viewBox="0 0 32 32">
          <title>Speech</title>
          <path d="M21.795 5.333h-11.413c-0.038 0-0.077 0-0.114 0l-0.134 0.011v2.796c0.143-0.006 0.273-0.009 0.385-0.009h11.277c0.070 0 7.074 0.213 7.074 7.695 0 5.179-2.956 7.695-9.036 7.695h-3.792c-0.691 0-1.12 0.526-1.38 1.159l-1.387 3.093-1.625 3.77 0.245 0.453h2.56l2.538-5.678h2.837c7.633 0 11.84-3.727 11.84-10.494 0.001-8.564-7.313-10.492-9.875-10.492z" />
          <path d="M10.912 24.259c-0.242-0.442-0.703-0.737-1.234-0.737-0 0-0 0-0 0h-0.56c-0.599-0.011-1.171-0.108-1.71-0.28l0.042 0.012c-1.82-0.559-4.427-2.26-4.427-7.424 0-6.683 5.024-7.597 7.109-7.686v-2.8c-2.042 0.095-9.91 1.067-9.91 10.483 0 4.832 1.961 7.367 3.606 8.64 1.38 1.067 3.109 1.744 4.991 1.843l0.033 0.019 2.805 5.211 1.41-3.273z" />
        </symbol>
      
        <!-- Send icon -->
        <symbol id="icon-send" viewBox="0 0 23.97 21.9">
          <title>Send</title>
          <path d="M0.31,9.43a0.5,0.5,0,0,0,0,.93l8.3,3.23L23.15,0Z" />
          <path d="M9,14.6H9V21.4a0.5,0.5,0,0,0,.93.25L13.22,16l6,3.32A0.5,0.5,0,0,0,20,19l4-18.4Z" />
        </symbol>
    

        <!-- Avatar icon -->
        <symbol id="avatar" width="32" height="32" viewBox="0 0 44.25 44">
          <title>Avatar</title>
          <path style="fill: #7226e0; fill-rule: evenodd;" d="M1035.88,1696.25a22,22,0,1,1-22.13,22A22.065,22.065,0,0,1,1035.88,1696.25Z" transform="translate(-1013.75 -1696.25)" />
          <path style="fill: #fff; fill-rule: evenodd;" d="M1030.18,1725.16h2.35a0.335,0.335,0,0,0,.34-0.33v-5.23h5.94v5.23a0.342,0.342,0,0,0,.34.33h2.36a0.342,0.342,0,0,0,.34-0.33v-12.36a0.34,0.34,0,0,0-.34-0.32h-2.36a0.34,0.34,0,0,0-.34.32v4.51h-5.94v-4.51a0.333,0.333,0,0,0-.34-0.32h-2.35a0.333,0.333,0,0,0-.34.32v12.36a0.335,0.335,0,0,0,.34.33" transform="translate(-1013.75 -1696.25)" />
        </symbol>
      
      </svg>
      <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script> -->
      <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.0.8/popper.min.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/js/bootstrap.min.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.3/jquery.mCustomScrollbar.concat.min.js'></script>
    
<script>

var suggession;
//speech reco
try {
  var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  var recognition = new SpeechRecognition();
}
catch(e) {
  console.error(e);
  $('.no-browser-support').show();
}
//const loader = `<span class='loader'><span class='loader__dot'></span><span class='loader__dot'>Typing</span><span class='loader__dot'></span></span>`;

const loader = `<span class='loader'><span style="color:green"><em>typing</em></span><span class='loader__dot'></span><span class='loader__dot'></span><span class='loader__dot'></span></span>`;
const errorMessage =
  "My apologies, I'm not avail at the moment, however, feel free to call our support team directly 0123456789.";
const urlPattern = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
const $document = document;
const $chatbot = $document.querySelector(".chatbot");
const $chatbotMessageWindow = $document.querySelector(
  ".chatbot__message-window"
);

const $chatbotHeader = $document.querySelector(".chatbot__header");
const $chatbotMessages = $document.querySelector(".chatbot__messages");
const $chatbotMessages1 = $document.querySelector("#chatwindow");
const $chatbotMessages2 = $document.querySelector("#ChatWindowdiv");
const $chatbotInput = $document.querySelector(".chatbot__input");
const $chatbotSubmit = $document.querySelector(".chatbot__submit1");
const $chatbotSubmit2 = $document.querySelector(".chatbot__submit2");
const $chatbotSubmit3 = $document.querySelector(".chatbot__submit3");

const botLoadingDelay = 1000;
const botReplyDelay = 2000;

$('#queries').hide();
$('#statuscheck').hide();
$("#agents").hide();
const resetInputField = () => {
  $chatbotInput.value = "";
};
function tabtype(tabname){

    resetInputField();
    if(tabname=="queries"){
        $('#queries').show();
    $('#statuscheck').hide();
    $("#agents").hide();
    $('#start-record-btn').on('click', function(e) {
    recognition.start();
    });
        document.addEventListener(
    "keypress",
    (event) => {
        if (event.which == 13) validateMessage();
    },
    false
    );
    const validateMessage = () => {
    const text = $chatbotInput.value;
    const safeText = text ? escapeScript(text) : "";
    if (safeText.length && safeText !== " ") {
        resetInputField();
        userMessage(safeText);
        send(safeText);
    }
    scrollDown();
    return;
    };

    const escapeScript = (unsafe) => {
    const safeString = unsafe
        .replace(/</g, " ")
        .replace(/>/g, " ")
        .replace(/&/g, " ")
        .replace(/"/g, " ")
        .replace(/\\/, " ")
        .replace(/\s+/g, " ");
    return safeString.trim();
    };

    const linkify = (inputText) => {
    return inputText.replace(urlPattern, `<a href='$1' target='_blank'>$1</a>`);
    };

    const resetInputField = () => {
    $chatbotInput.value = "";
    };

    const scrollDown = () => {
    const distanceToScroll =
        $chatbotMessageWindow.scrollHeight -
        ($chatbotMessages.lastChild.offsetHeight + 60);
    $chatbotMessageWindow.scrollTop = distanceToScroll;
    return false;
    };
    const toggle = (element, klass) => {
    const classes = element.className.match(/\S+/g) || [],
        index = classes.indexOf(klass);
    index >= 0 ? classes.splice(index, 1) : classes.push(klass);
    element.className = classes.join(" ");
    };

    const userMessage = (content) => {
    $chatbotMessages.innerHTML += `<li class='is-user animation'>
        <p class='chatbot__message'>
            ${content}
        </p>
        <span class='chatbot__arrow chatbot__arrow--right'></span>
        </li>`;
    };

    const aiMessage = (content, isLoading = false, delay = 0) => {
    setTimeout(() => {
        removeLoader();
        $chatbotMessages.innerHTML += `<li 
        class='is-ai animation' 
        id='${isLoading ? "is-loading" : ""}'>
            <div class="is-ai__profile-picture">
            <svg class="icon-avatar" viewBox="0 0 32 32">
                <use xlink:href="#avatar" />
            </svg>
            </div>
            <span class='chatbot__arrow chatbot__arrow--left'></span>
            <div class='chatbot__message'>${content}</div>
        </li>`;
        scrollDown();
    }, delay);
    };

    const removeLoader = () => {
    let loadingElem = document.getElementById("is-loading");
    if (loadingElem) $chatbotMessages.removeChild(loadingElem);
    };



    const processResponse = (val) => {
    if (val) {
        let output = "";
        output += `<p>${val.txt}</p>`;
        if(val.uri!=""){
        // output += `<p>${destinationName}</p>`;
            output += `<a href='${val.uri}' target="_blank">${val.destinationName}</a>`;

        }
        removeLoader();
        return output;
    }

    removeLoader();
    return `<p>${errorMessage}</p>`;
    };

    const setResponse = (val, delay = 0) => {
    setTimeout(() => {
        aiMessage(processResponse(val));
    }, delay);
    };

    $chatbotHeader.addEventListener(
    "click",
    () => {
        toggle($chatbot, "chatbot--closed");
        $chatbotInput.focus();
    },
    false
    );

    $chatbotSubmit.addEventListener(
    "click",
    () => {
        validateMessage();
    },
    false
    );

    const multiChoiceAnswer = (text) => {
    const decodedText = text.replace(/zzz/g, "'");
    userMessage(decodedText);
    send(decodedText);
    scrollDown();
    return;
    };

    const send = (text = "") => {
    var data = new URLSearchParams();
    data.append('MSG', text);
    var obj = {
    method: 'POST',
    body:data,
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
    },
    
    };
    fetch('https://velozitystudio.com:5444/send-msg', obj)
        .then((response) => response.json())
        .then((res) => {
        if (res.status < 200 || res.status >= 300) {
            let error = new Error(res.statusText);
            throw error;
        }
        return res;
        })
        .then((res) => {
        speechSynthesis.speak( new SpeechSynthesisUtterance(res.txt))
        setResponse(res, botLoadingDelay + botReplyDelay);
        })
        .catch((error) => {
        setResponse(errorMessage, botLoadingDelay + botReplyDelay);
        resetInputField();
        });
    aiMessage(loader, true, botLoadingDelay);
    };

    recognition.onresult = (event) => {
    const speechToText = event.results[0][0].transcript;
    userMessage(speechToText);
    send(speechToText);
    }
    }
    if(tabname=="status"){

    $('#queries').hide ();
    $('#statuscheck').show();
    $("#agents").hide();
    $('#start-record-btn2').on('click', function(e) {
    recognition.start();
    });
    const scrollDown = () => {
    const distanceToScroll =
        $chatbotMessageWindow.scrollHeight -
        ($chatbotMessages1.lastChild.offsetHeight + 60);
    $chatbotMessageWindow.scrollTop = distanceToScroll;
    return false;
    };
    const toggle = (element, klass) => {
    const classes = element.className.match(/\S+/g) || [],
        index = classes.indexOf(klass);
    index >= 0 ? classes.splice(index, 1) : classes.push(klass);
    element.className = classes.join(" ");
    };

    const userMessage = (content) => {
        console.log("User==> ",content);
    $chatbotMessages1.innerHTML += `<li class='is-user animation'>
        <p class='chatbot__message'>
            ${content}
        </p>
        <span class='chatbot__arrow chatbot__arrow--right'></span>
        </li>`;
    };

    const aiMessage = (content, isLoading = false, delay = 0) => {
        console.log(content);
    setTimeout(() => {
        removeLoader();
        $chatbotMessages1.innerHTML += `<li 
        class='is-ai animation' 
        id='${isLoading ? "is-loading" : ""}'>
            <div class="is-ai__profile-picture">
            <svg class="icon-avatar" viewBox="0 0 32 32">
                <use xlink:href="#avatar" />
            </svg>
            </div>
            <span class='chatbot__arrow chatbot__arrow--left'></span>
            <div class='chatbot__message'>${content}</div>
        </li>`;
        scrollDown();
    }, delay);
    };

    const removeLoader = () => {
    let loadingElem = document.getElementById("is-loading");
    if (loadingElem) $chatbotMessages1.removeChild(loadingElem);
    };


    const processResponse = (val) => {
    if (val) {
        let output = "";
        output += `<p>${val}</p>`;
        removeLoader();
        return output;
    }

    removeLoader();
    return `<p>${errorMessage}</p>`;
    };

     const setResponse = (val, delay = 0) => {
        setTimeout(() => {
            aiMessage(processResponse(val));
        }, delay);
        };

     $(document).ready(function(){
	window.globalVar = 1;		
	//create initial layout
		
    var arr=[];
    function validateEmail($email) {
    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
    return emailReg.test( $email );
    }

const send = (email,password,number) => {
        $.ajax({
        type: "Post",
        url: "https://velozitystudio.com:5444/sendlogin",
        data: {'username': email,'password': password},
        success: function(result){
        console.log(result);
        checkingStatus(result,number);
        },error:function(err){
            setTimeout(function () {
                                $('.class123').hide();
                                setResponse("Invalid Login Data!", botLoadingDelay + botReplyDelay);
                                speechSynthesis.speak( new SpeechSynthesisUtterance("Invalid Login Data!"));
                                localStorage.clear();
                                
                    }, 2000);
             }
        });
        };

const checkingStatus = (token,number) => {
        $.ajax({
        type: "Post",
        url: "https://velozitystudio.com:5444/shipmentstatus",
        data: {'shipmentNo': number,"token":token},
        success: function(result){
            console.log(result);
            if(result=="invalid"){
                setTimeout(function () {
                                $('.class123').hide();
                                setResponse("Invalid Data! Please enter correct data!", botLoadingDelay + botReplyDelay);
                                speechSynthesis.speak( new SpeechSynthesisUtterance("Invalid Data! Please enter correct data!"));
                                localStorage.clear();
                                scrollDown();
                    }, 2000);
            }else{
                setTimeout(function () {
                                $('.class123').hide();
                                setResponse(result.data.status_text, botLoadingDelay + botReplyDelay);
                                speechSynthesis.speak( new SpeechSynthesisUtterance(result.data.status_text));
                                localStorage.clear();
                                scrollDown();
                    }, 2000);
            }
        
        },error:function(err){
            console.log(err);
        }
        });
};

	var ProcessContainer = {
			ProcessUserMessage: function (e,texttoinput) {
			window.globalVar += 1;
			$('.class123').hide();
            if(localStorage.getItem("greeting")!=null && localStorage.getItem("username")==null){
                     setTimeout(function () {
                        $('.class123').hide();
                        setResponse('Please enter your logiseye Email?', botLoadingDelay + botReplyDelay);
                        speechSynthesis.speak( new SpeechSynthesisUtterance('Please enter your logiseye Email?'));
                        scrollDown();
                    }, 2000);
           }
           else if(localStorage.getItem("username")!=null && localStorage.getItem("greeting")!=null && localStorage.getItem("password")==null){
                     setTimeout(function () {
                        $('.class123').hide();
                          
                        setResponse('Please enter your password?', botLoadingDelay + botReplyDelay);
                        speechSynthesis.speak( new SpeechSynthesisUtterance('Please enter your password?'));
                        scrollDown();
                    }, 2000);
           }
           else if(localStorage.getItem("username")!=null && localStorage.getItem("greeting")!=null && localStorage.getItem("password")!=null  && localStorage.getItem("shiperNo")==null){
                     setTimeout(function () {
                        $('.class123').hide(); 
                        setResponse('Please enter your shipment or order number?', botLoadingDelay + botReplyDelay);
                        speechSynthesis.speak( new SpeechSynthesisUtterance('Please enter your shipment or order number?')); 
                        scrollDown();
                    }, 2000);
           }
           else {
                  
                    send(localStorage.getItem("username"),localStorage.getItem("password"),localStorage.getItem("shiperNo"));
           }
		}
    }
    
	var UserMessageContainer = {
    UserMessage: function (e,texttoinput) {
	
                 localStorage.setItem("greeting","hello");

                 if( localStorage.getItem("greeting")!=null && localStorage.getItem("username")==null){
                     if(validateEmail(texttoinput)==true){
                        localStorage.setItem("username",texttoinput);
                     }
                 }
                else if( localStorage.getItem("greeting")!=null && localStorage.getItem("username")!=null && localStorage.getItem("password")==null){
                        localStorage.setItem("password",texttoinput);
                 }
                 else if( localStorage.getItem("greeting")!=null && localStorage.getItem("username")!=null && localStorage.getItem("password")!=null && localStorage.getItem("shiperNo")==null){ 
                       localStorage.setItem("shiperNo",texttoinput);
                 }
        ProcessContainer.ProcessUserMessage(e,texttoinput);    
		$("#UserInputBox").val("");
    	}
	}
    $('.chatbot__submit2').click(function(e){
            UserMessageContainer.UserMessage(e,$("#UserInputBox").val());
            userMessage($("#UserInputBox").val());
            aiMessage(loader, true, botLoadingDelay);
          
    });
	
	$("#UserInputBox").keypress(function(e) {
		if(e.which == 13) {
            if($("#UserInputBox").val()!=null || $("#UserInputBox").val()!=""){  
            userMessage($("#UserInputBox").val());
           UserMessageContainer.UserMessage(e,$("#UserInputBox").val());
           aiMessage(loader, true, botLoadingDelay);
        }       
    }

	});

	$(".message1").click(function(e){
        UserMessageContainer.UserMessage(e,$("#UserInputBox").val());
        userMessage($("#UserInputBox").val());
        aiMessage(loader, true, botLoadingDelay);
    
	});
  
   
    function startstatus(){
        $("#UserInputBox").val("");
        setResponse('Hello there! Welcome to LogiBot! Hi there üñê. I‚Äôm Logibot, your virtual assistant.', botLoadingDelay + botReplyDelay);
        speechSynthesis.speak( new SpeechSynthesisUtterance('Hello there! Welcome to LogiBot!')); 
		$('#usertextboxmessage').fadeIn(1000);
        $('#UserInputBox').focus();
        aiMessage(loader, true, botLoadingDelay);

    };
    startstatus();
    recognition.onresult = (event) => {
        const speechToText = event.results[0][0].transcript;
        UserMessageContainer.UserMessage(event,$("#UserInputBox").val());
        userMessage(speechToText);
}
});

 }
if(tabname=="agent"){
    const scrollDown = () => {
  const distanceToScroll =
    $chatbotMessageWindow.scrollHeight -
    ($chatbotMessages2.lastChild.offsetHeight + 60);
     $chatbotMessageWindow.scrollTop = distanceToScroll;
  return false;
};
    $(document).ready(function(){

    function sendmsg(msg){
        var datajson ={message:msg}
            $.ajax({
            type: "Post",
            url: "https://velozitystudio.com:5441/newconversation?userId="+localStorage.getItem("userID"),
            data: datajson,
            cache: false,
            success: function(result){
                var data=JSON.parse(result);
                
                localStorage.setItem("cID",data.conversation_id)
                 msglist();
            },error:function(err){
                console.log(err);
            }
            });
            $("#UserInputBox2").val('');
            $("#UserInputBox2").focus();
            scrollDown();
    }

    $("#UserInputBox2").keypress(function(e) {
   	    if(e.which == 13) {
            sendmsg($("#UserInputBox2").val());
        }
	});




function sender(msg) {
  $('.chatbot__messages3').append(`<li 
      class='is-ai animation'>
        <div class="is-ai__profile-picture">
          <svg class="icon-avatar" viewBox="0 0 32 32">
            <use xlink:href="#avatar" />
          </svg>
        </div>
        <span class='chatbot__arrow chatbot__arrow--left'></span>
        <div class='chatbot__message'>${msg}</div>
      </li>`);
}

function res(msg) {
  $('.chatbot__messages3').append(`<li class='is-user animation'>
      <p class='chatbot__message'>
        ${msg}
      </p>
      <span class='chatbot__arrow chatbot__arrow--right'></span>
    </li>`);
}


function checking(){
    $('#queries').hide();
    $('#statuscheck').hide();
    $("#agents").hide();
    if(localStorage.getItem("userID")==null || localStorage.getItem("userID")==undefined){
        $("#msform").show();
           $("#msg").hide();
           $("#agent").hide();
           $("#agents").hide();
    }else{
        $("#msform").hide();
           $("#msg").show();
           $("#agent").show();
           $("#agents").show();
    }
}
checking();
const msglist = () => {
        $.ajax({
                type: "Get",
                url: "https://velozitystudio.com:5441/allconversationList?storage="+localStorage.getItem("userID")+"&convertId="+localStorage.getItem("cID"),
                cache: false,
                success: function(result){
                var data=JSON.parse(result);  
                    $('.chatbot__messages3').html('');
                var element = document.getElementById('ChatWindowdiv');
                if(data.messages!=undefined){
                data.messages.reverse();
                    for(var x=0;x<data.messages.length;x++){
                        if(data.messages[x].actor_type=="user"){
                        res(data.messages[x].message_parts[0].text.content);
                        
                        }
                        if(data.messages[x].actor_type=="agent"){
                        sender(data.messages[x].message_parts[0].text.content);
                            
                        }
                    }
                    scrollDown();
                }
            }
        });

};


setInterval(msglist, 3500);
$("#next").click(function(){
    var data = {
            email:$("#email").val(),
            fname:$("#fname").val(),
            lname:$("#fname").val()
        }   
        $.ajax({
        type: "Post",
        url: "https://velozitystudio.com:5441/newuser",
        data: data,
        cache: false,
        success: function(result){
            localStorage.setItem("userID", result.id);
            
             $("#msform").hide();
             $("#msg").show();
             $("#agent").show();    
             $("#agents").show();
        }
        });
    });
});
}
}


$(document).ready(function(){
	
	$('ul.tabs li').click(function(){
		var tab_id = $(this).attr('data-tab');

		$('ul.tabs li').removeClass('current');
		$('.tab-content').removeClass('current');

		$(this).addClass('current');
		$("#"+tab_id).addClass('current');
    });
    tabtype("queries");

})
</script>

</body>
</html>